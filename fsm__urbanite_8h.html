<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Project Template: common/include/fsm_urbanite.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Project Template
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('fsm__urbanite_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">fsm_urbanite.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Header for <a class="el" href="fsm__urbanite_8c.html" title="Urbanite FSM main file.">fsm_urbanite.c</a> file.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdint.h&gt;</code><br />
<code>#include &quot;fsm.h&quot;</code><br />
<code>#include &quot;<a class="el" href="fsm__button_8h_source.html">fsm_button.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="fsm__display_8h_source.html">fsm_display.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="fsm__ultrasound_8h_source.html">fsm_ultrasound.h</a>&quot;</code><br />
</div>
<p><a href="fsm__urbanite_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfsm__urbanite__t.html">fsm_urbanite_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure that contains the information of a distance measurement system.  <a href="structfsm__urbanite__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ab3c277bf810895db38a66dc3fc7e718e"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fsm__urbanite_8h.html#ab3c277bf810895db38a66dc3fc7e718e">FSM_URBANITE</a> { <br />
&#160;&#160;<a class="el" href="fsm__urbanite_8h.html#ab3c277bf810895db38a66dc3fc7e718eaac132f2982b98bcaa3445e535a03ff75">OFF</a> = 0, 
<br />
&#160;&#160;<a class="el" href="fsm__urbanite_8h.html#ab3c277bf810895db38a66dc3fc7e718ea10b4381a926db55ed18619513fb12a28">MEASURE</a>, 
<br />
&#160;&#160;<a class="el" href="fsm__urbanite_8h.html#ab3c277bf810895db38a66dc3fc7e718ea56b36d0d0bb01b339cf1041adc08e262">PAUSE</a>, 
<br />
&#160;&#160;<a class="el" href="fsm__urbanite_8h.html#ab3c277bf810895db38a66dc3fc7e718ea30dd63ccd40677f8b3eb01f8ad352ce7">SLEEP_WHILE_OFF</a>, 
<br />
&#160;&#160;<a class="el" href="fsm__urbanite_8h.html#ab3c277bf810895db38a66dc3fc7e718eacfc8a9bfe175888d8890411703c267f4">SLEEP_WHILE_ON</a>
<br />
 }</td></tr>
<tr class="memdesc:ab3c277bf810895db38a66dc3fc7e718e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enumerator for the Urbanite finite state machine.  <a href="fsm__urbanite_8h.html#ab3c277bf810895db38a66dc3fc7e718e">More...</a><br /></td></tr>
<tr class="separator:ab3c277bf810895db38a66dc3fc7e718e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ae6d50a1c3ff856e2ce0b926b30193bcc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fsm__urbanite_8h.html#ae6d50a1c3ff856e2ce0b926b30193bcc">fsm_urbanite_init</a> (<a class="el" href="structfsm__urbanite__t.html">fsm_urbanite_t</a> *p_fsm_urbanite, <a class="el" href="structfsm__button__t.html">fsm_button_t</a> *p_fsm_button, uint32_t on_off_press_time_ms, uint32_t pause_display_time_ms, <a class="el" href="structfsm__ultrasound__t.html">fsm_ultrasound_t</a> *p_fsm_ultrasound_rear, <a class="el" href="structfsm__display__t.html">fsm_display_t</a> *p_fsm_display_rear)</td></tr>
<tr class="memdesc:ae6d50a1c3ff856e2ce0b926b30193bcc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a new Urbanite FSM.  <a href="fsm__urbanite_8h.html#ae6d50a1c3ff856e2ce0b926b30193bcc">More...</a><br /></td></tr>
<tr class="separator:ae6d50a1c3ff856e2ce0b926b30193bcc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7089a009a41131be554fca56de57bdfb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fsm__urbanite_8h.html#a7089a009a41131be554fca56de57bdfb">fsm_urbanite_fire</a> (<a class="el" href="structfsm__urbanite__t.html">fsm_urbanite_t</a> *p_fsm)</td></tr>
<tr class="memdesc:a7089a009a41131be554fca56de57bdfb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fire the Urbanite FSM.  <a href="fsm__urbanite_8h.html#a7089a009a41131be554fca56de57bdfb">More...</a><br /></td></tr>
<tr class="separator:a7089a009a41131be554fca56de57bdfb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Header for <a class="el" href="fsm__urbanite_8c.html" title="Urbanite FSM main file.">fsm_urbanite.c</a> file. </p>
<dl class="section author"><dt>Author</dt><dd>Sistemas Digitales II </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2025-01-01 </dd></dl>

<p class="definition">Definition in file <a class="el" href="fsm__urbanite_8h_source.html">fsm_urbanite.h</a>.</p>
</div><h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="ab3c277bf810895db38a66dc3fc7e718e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3c277bf810895db38a66dc3fc7e718e">&#9670;&nbsp;</a></span>FSM_URBANITE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="fsm__urbanite_8h.html#ab3c277bf810895db38a66dc3fc7e718e">FSM_URBANITE</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enumerator for the Urbanite finite state machine. </p>
<p>This enumerator defines the different states that the Urbanite finite state machine can be in. Each state represents a specific condition or step in the process of showing the distance to the nearest obstacle. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="ab3c277bf810895db38a66dc3fc7e718eaac132f2982b98bcaa3445e535a03ff75"></a>OFF&#160;</td><td class="fielddoc"><p>Starting state. Also comes here when the button has been pressed for the required time to turn OFF the Urbanite </p>
</td></tr>
<tr><td class="fieldname"><a id="ab3c277bf810895db38a66dc3fc7e718ea10b4381a926db55ed18619513fb12a28"></a>MEASURE&#160;</td><td class="fielddoc"><p>State to measure the distance to the obstacles </p>
</td></tr>
<tr><td class="fieldname"><a id="ab3c277bf810895db38a66dc3fc7e718ea56b36d0d0bb01b339cf1041adc08e262"></a>PAUSE&#160;</td><td class="fielddoc"><p>State to pause the display </p>
</td></tr>
<tr><td class="fieldname"><a id="ab3c277bf810895db38a66dc3fc7e718ea30dd63ccd40677f8b3eb01f8ad352ce7"></a>SLEEP_WHILE_OFF&#160;</td><td class="fielddoc"><p>State to start the low power mode while the Urbanite is OFF </p>
</td></tr>
<tr><td class="fieldname"><a id="ab3c277bf810895db38a66dc3fc7e718eacfc8a9bfe175888d8890411703c267f4"></a>SLEEP_WHILE_ON&#160;</td><td class="fielddoc"><p>State to start the low power mode while the Urbanite is ON </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="fsm__urbanite_8h_source.html#l00029">29</a> of file <a class="el" href="fsm__urbanite_8h_source.html">fsm_urbanite.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a7089a009a41131be554fca56de57bdfb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7089a009a41131be554fca56de57bdfb">&#9670;&nbsp;</a></span>fsm_urbanite_fire()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fsm_urbanite_fire </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfsm__urbanite__t.html">fsm_urbanite_t</a> *&#160;</td>
          <td class="paramname"><em>p_fsm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fire the Urbanite FSM. </p>
<p>This function is used to check the transitions and execute the actions of the Urbanite FSM.</p>
<blockquote class="doxtable">
<p><b>TO-DO alumnos:</b></p>
<p>✅ 1. Call function <code>fsm_fire()</code> with the received pointer to <code>fsm_t</code> <br  />
</p>
</blockquote>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p_fsm</td><td>Pointer to the <code><a class="el" href="structfsm__urbanite__t.html" title="Structure that contains the information of a distance measurement system.">fsm_urbanite_t</a></code> struct. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="fsm__urbanite_8c_source.html#l00297">297</a> of file <a class="el" href="fsm__urbanite_8c_source.html">fsm_urbanite.c</a>.</p>

</div>
</div>
<a id="ae6d50a1c3ff856e2ce0b926b30193bcc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6d50a1c3ff856e2ce0b926b30193bcc">&#9670;&nbsp;</a></span>fsm_urbanite_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fsm_urbanite_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfsm__urbanite__t.html">fsm_urbanite_t</a> *&#160;</td>
          <td class="paramname"><em>p_fsm_urbanite</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structfsm__button__t.html">fsm_button_t</a> *&#160;</td>
          <td class="paramname"><em>p_fsm_button</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>on_off_press_time_ms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>pause_display_time_ms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structfsm__ultrasound__t.html">fsm_ultrasound_t</a> *&#160;</td>
          <td class="paramname"><em>p_fsm_ultrasound_rear</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structfsm__display__t.html">fsm_display_t</a> *&#160;</td>
          <td class="paramname"><em>p_fsm_display_rear</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a new Urbanite FSM. </p>
<p>This FSM implements a system that measures the distance to the nearest obstacle and shows it on a display. The display is a RGB LED that changes its color depending on the distance to the obstacle. The system is activated by pressing a button. The system is deactivated by pressing the same button for the same time.</p>
<p>The basic implementation of this FSM assumes that the system is mounted on a car and the distance is measured by an ultrasound sensor located at the rear of the car. The display is located on the dashboard of the car. The button is assumed that activates when the driver is parking the car. The system can add more sensors and displays to cover more areas of the car.</p>
<p>A short press of the button deactivates the display if it disturbs the driver, but the system continues measuring the distance. In case the driver wants to activate the display again, he must press the button again and the display will show the last distance measured. A long press of the button deactivates the ultrasounds and the displays.</p>
<p>When the system is OFF it does not measure the distance and the display is OFF. The system is in a low power mode.</p>
<p>To better understand the system, please watch the following video:</p>
<p> 
<iframe width="854" height="480" src="https://www.youtube.com/embed/cUdxMichHwM" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</p>
<p>This is the HW diagram of the system:</p>
<div class="image">
<img src="urbanite_fritzing.png" alt=""/>
</div>
<p>This function initializes the default values of the FSM struct and calls to the <code>port</code> to initialize the HWs associated to the devices.</p>
<blockquote class="doxtable">
<p><b>TO-DO alumnos:</b></p>
<p>✅ 1. Call function <code>fsm_init()</code> with the received pointer to <code>fsm_t</code> and the transition table <br  />
✅ 2. Initialize the fields <code>p_fsm_button</code>, <code>on_off_press_time_ms</code> <code>p_fsm_ultrasound_rear</code>, and <code>p_fsm_display_rear</code> of <code>p_fsm_urbanite</code> with the received values <br  />
</p>
</blockquote>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p_fsm_urbanite</td><td>Pointer to the <code><a class="el" href="structfsm__urbanite__t.html" title="Structure that contains the information of a distance measurement system.">fsm_urbanite_t</a></code> struct that could contain many ultrasound sensors and displays. </td></tr>
    <tr><td class="paramname">p_fsm_button</td><td>Pointer to the button FSM that activates the system and disables the display if it disturbs the driver. </td></tr>
    <tr><td class="paramname">on_off_press_time_ms</td><td>Button press time in milliseconds to turn the system ON or OFF </td></tr>
    <tr><td class="paramname">pause_display_time_ms</td><td>Time in milliseconds to pause the display after a short press of the button </td></tr>
    <tr><td class="paramname">p_fsm_ultrasound_rear</td><td>Pointer to the ultrasound FSM that measures the distance to the rear obstacle. </td></tr>
    <tr><td class="paramname">p_fsm_display_rear</td><td>Pointer to the display FSM that shows the distance to the rear obstacle. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="fsm__urbanite_8c_source.html#l00285">285</a> of file <a class="el" href="fsm__urbanite_8c_source.html">fsm_urbanite.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_bdd9a5d540de89e9fe90efdfc6973a4f.html">common</a></li><li class="navelem"><a class="el" href="dir_11fbc4217d50ab21044e5ad6614aede5.html">include</a></li><li class="navelem"><a class="el" href="fsm__urbanite_8h.html">fsm_urbanite.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
